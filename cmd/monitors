#!/bin/sh
#~~~ set display mode with xrandr based on number of connected displays
# xrandr commands generated by arandr

# Get number of connected displays
case "$1" in
    1|2) monitor_count="$1" ;;
    '')  monitor_count=$(xrandr | awk '/ connected/ {count++} END {print count}') ;;
    *) 
        echo 'monitors: invalid monitor number'
        echo 'must be [1|2] or left blank'
esac

if [ ! "$monitor_count" = '2' ]; then
    # Single display, or fallback
    xrandr  --output eDP-1 --primary --mode 1680x1050 --pos 0x0 --rotate normal \
            --output HDMI-1 --off \
            --output DP-1 --off \
            --output DP-2 --off \
            --output DP-3 --off \
            --output DP-4 --off
    echo 'Applied xrandr settings for 1 monitor'
else
    # Secondary monitor
    xrandr  --output eDP-1 --primary --mode 1680x1050 --pos 0x0 --rotate normal \
            --output HDMI-1 --mode 1920x1080 --pos 1680x0 --rotate normal \
            --output DP-1 --off \
            --output DP-2 --off \
            --output DP-3 --off \
            --output DP-4 --off
    echo 'Applied xrandr settings for 2 monitors'
fi
